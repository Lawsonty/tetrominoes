<!DOCTYPE html>
<meta charset="UTF-8" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/5.4.0/math.min.js" type="text/javascript"></script>
<script src = "js/three.js" type="text/javascript"></script>
<script src="js/tetris.js" type="text/javascript"></script>
<script src = "js/display.js" type="text/javascript"></script>

<head>
    <link rel="stylesheet" href="/public/index.css">
</head>
<html>

<body>
    <!-- <p>Click the button to test the function.</p> -->
    <canvas id="tetro_window" width="400" height="800" style="border:1px solid #000000;" >
    </canvas>

    <script id="t_vert_shader" type="x-shader/x-vertex">
        uniform float time;
    
    </script>


    <script>
        var tickCount = 0;
        var intervalObj = null;
        var disp = new Display("tetro_window");

        function myFunction() {
            if (tickCount % 10 == 0) {
                state.tick();
            }
            //boardUpdate();
            disp.display(state.free_blocks);
            //state.clear_rows()
            tickCount++;
        }

        document.addEventListener("keypress", function (event) {
            if (event.keyCode == 37) {
                state.shiftx_tetramino(-1);
            }
            if (event.keyCode == 38) {
                state.rotate_tetramino();
            }
            if (event.keyCode == 39) {
                state.shiftx_tetramino(1);
            }
            if (event.keyCode == 40) {
                console.log("down");
            }
        })

        function startFunc() {
            if (intervalObj == null) {
                //disp = new Display("tetro_window");
                intervalObj = window.setInterval(myFunction, 100);
            }            
        }

        function pauseFunc() {
            window.clearInterval(intervalObj);
            intervalObj = null;
        }

        function resetFunc() {
            pauseFunc();
            state.reset();
            disp.display(state.free_blocks);
        }

        //boardUpdate();
    </script>

    <div id="btnDiv">
        <button onclick="startFunc()">Start</button>
        <button onclick="pauseFunc()">Pause</button>
        <button onclick="resetFunc()">Reset</button>
    </div>
</body>

</html>
